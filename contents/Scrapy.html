<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <link rel="stylesheet" href="bases/style.css">
    <script src="bases/script.js"></script>
    <script src="bases/jquery.js"></script>
    <script>
        $(function () {
            $("#header").load("bases/uni-header.html");
            $("#footer").load("bases/uni-footer.html")
        });
    </script>
    <title>Scrapy</title>
</head>

<body>
<header id="header"></header>

<!--The Documentation Section Goes Here-->
<section id="Scrapy">
    <hr>
    <h3>Scrapy</h3>
    <p>Scrapy is a web crawling framework written in Python. It is a fast, high-level framework
        used to crawl websites and extract structured data from their pages. It is preferred to used rather than beautiful soup for complex data scraping projects. <a href="https://docs.scrapy.org/en/latest/" style="font-size: 1.3rem;" target="_blank">docs</a></p>
    <p>CREATE a new Scrapy project using the command-line tool. Navigate to the directory where you want to create your project and run:</p>
    <pre style="background-color: rgb(40, 44, 52);"><pre style=""><pre style=""><div style="color: rgb(187, 187, 187); font-family: &quot;JetBrains Mono&quot;, monospace;">scrapy startproject project_name</div></pre></pre></pre>
    <p>Above Command would make&nbsp;<span style="font-size: 20.8px;">below</span><span style="font-size: 1.3rem;">&nbsp;structure:</span></p>
    <pre style="background-color:#282c34;color:#abb2bf;font-family:'JetBrains Mono',monospace;font-size:۹٫۸pt;"><pre style="color: rgb(187, 187, 187); font-family: &quot;JetBrains Mono&quot;, monospace;"><pre style="font-family: &quot;JetBrains Mono&quot;, monospace;"><div>project_name<br>│<br>├── project_name<br>│   ├── __init__.py<br>│   ├── items.py<br>│   ├── middlewares.py<br>│   ├── pipelines.py<br>│   ├── settings.py<br>│   └── spiders<br>│       ├── __init__.py<br>│       └── my_spider.py<br>│<br>└── scrapy.cfg<br></div></pre></pre></pre>
    <p>Spiders are the heart of Scrapy. You define a spider to scrape specific websites. Create a spider file in the spiders directory.</p><p></p><pre style="font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; background-color: rgb(40, 44, 52); color: rgb(187, 187, 187); font-family: &quot;JetBrains Mono&quot;, monospace;"></pre><p></p><p style="font-size: 1.3rem; color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">RUN Your Spider Using a Command in Terminal or Make a Run File:</p><div style="background-color:#282c34;color:#bbbbbb;font-family:'JetBrains Mono',monospace;font-size:۹٫۸pt;white-space:pre;"><span style="color:#5c6370;font-style:italic;"># IN TERMINAL<br></span>scrapy crawl spider_name<br><br><span style="color:#5c6370;font-style:italic;"># IN A RUN.PY<br></span><span style="color:#d55fde;font-style:italic;">from </span>scrapy.crawler <span style="color:#d55fde;font-style:italic;">import </span>CrawlerProcess<br><span style="color:#d55fde;font-style:italic;">from </span>myproject.spiders <span style="color:#d55fde;font-style:italic;">import </span>MySpider<br><br>process = <span style="color:#61afef;">CrawlerProcess</span><span style="color:#e8ba36;">()<br></span>process.<span style="color:#61afef;">crawl</span><span style="color:#e8ba36;">(</span>MySpider<span style="color:#e8ba36;">)<br></span>process.<span style="color:#61afef;">start</span><span style="color:#e8ba36;">()<br></span><span style="color:#e8ba36;"><br></span></div><p>Here is a Sample Code of a Spider (to return title of the page):</p><div style="background-color: rgb(40, 44, 52);"><div style=""><div style=""><span style="color: rgb(213, 95, 222); font-family: &quot;JetBrains Mono&quot;, monospace; white-space: pre; font-style: italic;">import </span><font color="#bbbbbb" face="JetBrains Mono, monospace"><span style="white-space: pre;">scrapy</span></font><br><br><br><span style="color: rgb(213, 95, 222); font-family: &quot;JetBrains Mono&quot;, monospace; white-space: pre; font-style: italic;">class </span><span style="color: rgb(229, 192, 123); font-family: &quot;JetBrains Mono&quot;, monospace; white-space: pre;">BlogSpider</span><span style="color: rgb(232, 186, 54); font-family: &quot;JetBrains Mono&quot;, monospace; white-space: pre;">(</span><font color="#bbbbbb" face="JetBrains Mono, monospace"><span style="white-space: pre;">scrapy.Spider</span></font><span style="color: rgb(232, 186, 54); font-family: &quot;JetBrains Mono&quot;, monospace; white-space: pre;">)</span><font color="#bbbbbb" face="JetBrains Mono, monospace"><span style="white-space: pre;">:</span></font><br><font color="#bbbbbb" face="JetBrains Mono, monospace"><span style="white-space: pre;">    name = </span></font><span style="color: rgb(137, 202, 120); font-family: &quot;JetBrains Mono&quot;, monospace; white-space: pre;">'blogspider'<br></span><span style="color: rgb(137, 202, 120); font-family: &quot;JetBrains Mono&quot;, monospace; white-space: pre;">    </span><font color="#bbbbbb" face="JetBrains Mono, monospace"><span style="white-space: pre;">start_urls = </span></font><span style="color: rgb(232, 186, 54); font-family: &quot;JetBrains Mono&quot;, monospace; white-space: pre;">[</span><span style="color: rgb(137, 202, 120); font-family: &quot;JetBrains Mono&quot;, monospace; white-space: pre;">'https://docs.scrapy.org/en/latest/'</span><span style="color: rgb(232, 186, 54); font-family: &quot;JetBrains Mono&quot;, monospace; white-space: pre;">]  </span><span style="color: rgb(92, 99, 112); font-family: &quot;JetBrains Mono&quot;, monospace; white-space: pre; font-style: italic;"># page to start<br></span><span style="color: rgb(92, 99, 112); font-family: &quot;JetBrains Mono&quot;, monospace; white-space: pre; font-style: italic;"><br></span><span style="color: rgb(92, 99, 112); font-family: &quot;JetBrains Mono&quot;, monospace; white-space: pre; font-style: italic;"><br></span><span style="color: rgb(92, 99, 112); font-family: &quot;JetBrains Mono&quot;, monospace; white-space: pre; font-style: italic;">    </span><span style="color: rgb(213, 95, 222); font-family: &quot;JetBrains Mono&quot;, monospace; white-space: pre; font-style: italic;">def </span><span style="color: rgb(97, 175, 239); font-family: &quot;JetBrains Mono&quot;, monospace; white-space: pre;">parse</span><span style="color: rgb(232, 186, 54); font-family: &quot;JetBrains Mono&quot;, monospace; white-space: pre;">(</span><span style="color: rgb(213, 95, 222); font-family: &quot;JetBrains Mono&quot;, monospace; white-space: pre; font-style: italic;">self</span><font color="#bbbbbb" face="JetBrains Mono, monospace"><span style="white-space: pre;">, </span></font><span style="color: rgb(209, 154, 102); font-family: &quot;JetBrains Mono&quot;, monospace; white-space: pre;">response</span><span style="color: rgb(232, 186, 54); font-family: &quot;JetBrains Mono&quot;, monospace; white-space: pre;">)</span><font color="#bbbbbb" face="JetBrains Mono, monospace"><span style="white-space: pre;">: </span></font><span style="color: rgb(92, 99, 112); font-family: &quot;JetBrains Mono&quot;, monospace; white-space: pre; font-style: italic;"># </span><font color="#5c6370" face="JetBrains Mono, monospace"><span style="white-space: pre;"><i>This function is called automatically.</i></span></font><br><font color="#bbbbbb" face="JetBrains Mono, monospace"><span style="white-space: pre;">        title = </span></font><span style="color: rgb(209, 154, 102); font-family: &quot;JetBrains Mono&quot;, monospace; white-space: pre;">response</span><font color="#bbbbbb" face="JetBrains Mono, monospace"><span style="white-space: pre;">.</span></font><span style="color: rgb(97, 175, 239); font-family: &quot;JetBrains Mono&quot;, monospace; white-space: pre;">css</span><span style="color: rgb(232, 186, 54); font-family: &quot;JetBrains Mono&quot;, monospace; white-space: pre;">(</span><span style="color: rgb(137, 202, 120); font-family: &quot;JetBrains Mono&quot;, monospace; white-space: pre;">'h1 ::text'</span><span style="color: rgb(232, 186, 54); font-family: &quot;JetBrains Mono&quot;, monospace; white-space: pre;">)</span><font color="#bbbbbb" face="JetBrains Mono, monospace"><span style="white-space: pre;">.</span></font><span style="color: rgb(97, 175, 239); font-family: &quot;JetBrains Mono&quot;, monospace; white-space: pre;">extract</span><span style="color: rgb(232, 186, 54); font-family: &quot;JetBrains Mono&quot;, monospace; white-space: pre;">()<br></span><span style="color: rgb(232, 186, 54); font-family: &quot;JetBrains Mono&quot;, monospace; white-space: pre;">        </span><font color="#bbbbbb" face="JetBrains Mono, monospace"><span style="white-space: pre;">getting_help = </span></font><span style="color: rgb(209, 154, 102); font-family: &quot;JetBrains Mono&quot;, monospace; white-space: pre;">response</span><font color="#bbbbbb" face="JetBrains Mono, monospace"><span style="white-space: pre;">.</span></font><span style="color: rgb(97, 175, 239); font-family: &quot;JetBrains Mono&quot;, monospace; white-space: pre;">xpath</span><span style="color: rgb(232, 186, 54); font-family: &quot;JetBrains Mono&quot;, monospace; white-space: pre;">(</span><span style="color: rgb(137, 202, 120); font-family: &quot;JetBrains Mono&quot;, monospace; white-space: pre;">'//section/div/div/h2/text()'</span><span style="color: rgb(232, 186, 54); font-family: &quot;JetBrains Mono&quot;, monospace; white-space: pre;">)</span><font color="#bbbbbb" face="JetBrains Mono, monospace"><span style="white-space: pre;">.</span></font><span style="color: rgb(97, 175, 239); font-family: &quot;JetBrains Mono&quot;, monospace; white-space: pre;">extract</span><span style="color: rgb(232, 186, 54); font-family: &quot;JetBrains Mono&quot;, monospace; white-space: pre;">()<br></span><span style="color: rgb(232, 186, 54); font-family: &quot;JetBrains Mono&quot;, monospace; white-space: pre;">        </span><span style="color: rgb(213, 95, 222); font-family: &quot;JetBrains Mono&quot;, monospace; white-space: pre; font-style: italic;">yield </span><span style="color: rgb(232, 186, 54); font-family: &quot;JetBrains Mono&quot;, monospace; white-space: pre;">{</span><span style="color: rgb(137, 202, 120); font-family: &quot;JetBrains Mono&quot;, monospace; white-space: pre;">'title'</span><font color="#bbbbbb" face="JetBrains Mono, monospace"><span style="white-space: pre;">: title,</span></font><br>                <span style="color: rgb(137, 202, 120); font-family: &quot;JetBrains Mono&quot;, monospace; white-space: pre;">'getting_help'</span><font color="#bbbbbb" face="JetBrains Mono, monospace"><span style="white-space: pre;">: getting_help</span></font><span style="color: rgb(232, 186, 54); font-family: &quot;JetBrains Mono&quot;, monospace; white-space: pre;">}<br></span><span style="color: rgb(232, 186, 54); font-family: &quot;JetBrains Mono&quot;, monospace; white-space: pre;"><br></span></div></div></div><p><span style="font-size: 1.3rem;"><br></span></p><p><span style="font-size: 1.3rem;">Using Shell Terminal to be able to find and check selectors:</span></p><div style="background-color: rgb(40, 44, 52);"><font color="#bbbbbb" face="JetBrains Mono, monospace"><span style="white-space: pre;">$ scrapy shell  'https://docs.scrapy.org/en/latest/'</span></font></div><div><br></div><div><div style="background-color: rgb(40, 44, 52);"><font color="#bbbbbb" face="JetBrains Mono, monospace"><span style="white-space: pre;">&gt;&gt;&gt; response.css('h1 ::text').get()</span></font></div></div><div style="background-color: rgb(40, 44, 52);"><font color="#bbbbbb" face="JetBrains Mono, monospace"><span style="white-space: pre;"><br></span></font></div><div style="background-color: rgb(40, 44, 52);"><font color="#bbbbbb" face="JetBrains Mono, monospace"><span style="white-space: pre;">&gt;&gt;&gt; response.css('a').xpath('@href').extract()</span></font><span style="color: rgb(187, 187, 187); font-family: &quot;JetBrains Mono&quot;, monospace; white-space: pre;">
</span></div><div><br></div><p>STORING DATA:</p><p>1. To be able to store data, first we need to make some changes inside&nbsp;<span style="background-color: rgb(40, 44, 52); color: rgb(187, 187, 187); font-family: &quot;JetBrains Mono&quot;, monospace; white-space: pre;">items.py</span><span style="font-size: 1.3rem;">&nbsp;module.</span></p><div style="background-color:#282c34;color:#bbbbbb;font-family:'JetBrains Mono',monospace;font-size:۹٫۸pt;white-space:pre;"><span style="color:#d55fde;font-style:italic;">import </span>scrapy<br><br><span style="color:#d55fde;font-style:italic;">class </span><span style="color:#e5c07b;">MyItem</span><span style="color:#e8ba36;">(</span>scrapy.Item<span style="color:#e8ba36;">)</span>:<br>    title = scrapy.<span style="color:#61afef;">Field</span><span style="color:#e8ba36;">()<br></span><span style="color:#e8ba36;">    </span>description = scrapy.<span style="color:#61afef;">Field</span><span style="color:#e8ba36;">()<br></span><span style="color:#e8ba36;">    </span><br></div><p>2. Then change&nbsp;<span style="color: rgb(97, 175, 239); background-color: rgb(40, 44, 52); font-family: &quot;JetBrains Mono&quot;, monospace; white-space: pre;">parse</span><span style="font-size: 1.3rem;">&nbsp;function inside your spider module like below:</span></p><div style="background-color:#282c34;color:#bbbbbb;font-family:'JetBrains Mono',monospace;font-size:۹٫۸pt;white-space:pre;"><span style="color:#d55fde;font-style:italic;">def </span><span style="color:#61afef;">parse</span><span style="color:#e8ba36;">(</span><span style="color:#d55fde;font-style:italic;">self</span>, <span style="color:#d19a66;">response</span><span style="color:#e8ba36;">)</span>:<br>    item = <span style="color:#61afef;">MyItem</span><span style="color:#e8ba36;">()   <br></span><span style="color:#e8ba36;">    </span>item<span style="color:#e8ba36;">[</span><span style="color:#89ca78;">'title'</span><span style="color:#e8ba36;">] </span>= <span style="color:#d19a66;">response</span>.<span style="color:#61afef;">css</span><span style="color:#e8ba36;">(</span><span style="color:#89ca78;">'h1::text'</span><span style="color:#e8ba36;">)</span>.<span style="color:#61afef;">get</span><span style="color:#e8ba36;">()<br></span><span style="color:#e8ba36;">    </span>item<span style="color:#e8ba36;">[</span><span style="color:#89ca78;">'description'</span><span style="color:#e8ba36;">] </span>= <span style="color:#d19a66;">response</span>.<span style="color:#61afef;">css</span><span style="color:#e8ba36;">(</span><span style="color:#89ca78;">'p::text'</span><span style="color:#e8ba36;">)</span>.<span style="color:#61afef;">get</span><span style="color:#e8ba36;">()<br></span><span style="color:#e8ba36;"><br></span><span style="color:#e8ba36;">    </span><span style="color:#d55fde;font-style:italic;">yield </span>item  <span style="color:#5c6370;font-style:italic;"># Yield the item to be exported<br></span><span style="color:#5c6370;font-style:italic;">    </span><br></div><p>3. Finally, There are two ways to get the output file (in csv, json, jl, xml):</p><div style="background-color:#282c34;color:#bbbbbb;font-family:'JetBrains Mono',monospace;font-size:۹٫۸pt;white-space:pre;"><span style="color:#5c6370;font-style:italic;"># 1. Add these to settings.py<br></span>FEED_FORMAT = <span style="color:#89ca78;">'csv'<br></span>FEED_URI = <span style="color:#89ca78;">'output.csv'<br></span><span style="color:#89ca78;"><br></span><span style="color:#5c6370;font-style:italic;"># OR<br></span><span style="color:#5c6370;font-style:italic;"><br></span><span style="color:#5c6370;font-style:italic;"># 2. Running the script by a terminal command<br></span>scrapy crawl spider_name -o output.csv<br><br></div><p>To Store Data inside a database file, do step 1 and 2 above, then as the third step,</p><p>3. Uncomment the line below inside&nbsp;<span style="background-color: rgb(40, 44, 52); color: rgb(187, 187, 187); font-family: &quot;JetBrains Mono&quot;, monospace; font-size: 20.8px; white-space: pre;">settings.py</span><span style="font-size: 1.3rem;">.</span></p><div style="background-color:#282c34;color:#bbbbbb;font-family:'JetBrains Mono',monospace;font-size:۹٫۸pt;white-space:pre;">ITEM_PIPELINES = <span style="color:#e8ba36;">{<br></span><span style="color:#e8ba36;">   </span><span style="color:#89ca78;">"blog_scrape.pipelines.BlogScrapePipeline"</span>: <span style="color:#d19a66;">300</span>,<br><span style="color:#e8ba36;">}<br></span></div><p>4. Finally, Make below changes to the class inside&nbsp;<span style="background-color: rgb(40, 44, 52); color: rgb(187, 187, 187); font-family: &quot;JetBrains Mono&quot;, monospace; white-space: pre;">piplines.py</span><span style="font-size: 1.3rem;">:</span></p><div style="background-color:#282c34;color:#bbbbbb;font-family:'JetBrains Mono',monospace;font-size:۹٫۸pt;white-space:pre;"><span style="color:#d55fde;font-style:italic;">class </span><span style="color:#e5c07b;">BlogScrapePipeline</span>:<br>    <span style="color:#d55fde;font-style:italic;">def </span><span style="color:#61afef;">__init__</span><span style="color:#e8ba36;">(</span><span style="color:#d55fde;font-style:italic;">self</span><span style="color:#e8ba36;">)</span>:<br>        <span style="color:#d55fde;font-style:italic;">self</span>.<span style="color:#61afef;">create_connection</span><span style="color:#e8ba36;">()<br></span><span style="color:#e8ba36;">        </span><span style="color:#d55fde;font-style:italic;">self</span>.<span style="color:#61afef;">create_tables</span><span style="color:#e8ba36;">()<br></span><span style="color:#e8ba36;"><br></span><span style="color:#e8ba36;">    </span><span style="color:#d55fde;font-style:italic;">def </span><span style="color:#61afef;">create_connection</span><span style="color:#e8ba36;">(</span><span style="color:#d55fde;font-style:italic;">self</span><span style="color:#e8ba36;">)</span>:<br>        <span style="color:#5c6370;font-style:italic;"># Initialize the database connection<br></span><span style="color:#5c6370;font-style:italic;">        </span><span style="color:#d55fde;font-style:italic;">self</span>.conn = sqlite3.<span style="color:#61afef;">connect</span><span style="color:#e8ba36;">(</span><span style="color:#89ca78;">"blog.db"</span><span style="color:#e8ba36;">)<br></span><span style="color:#e8ba36;">        </span><span style="color:#d55fde;font-style:italic;">self</span>.curr = <span style="color:#d55fde;font-style:italic;">self</span>.conn.<span style="color:#61afef;">cursor</span><span style="color:#e8ba36;">()<br></span><span style="color:#e8ba36;"><br></span><span style="color:#e8ba36;">    </span><span style="color:#d55fde;font-style:italic;">def </span><span style="color:#61afef;">create_tables</span><span style="color:#e8ba36;">(</span><span style="color:#d55fde;font-style:italic;">self</span><span style="color:#e8ba36;">)</span>:<br>        <span style="color:#5c6370;font-style:italic;"># Create the table<br></span><span style="color:#5c6370;font-style:italic;">        </span><span style="color:#d55fde;font-style:italic;">self</span>.curr.<span style="color:#61afef;">execute</span><span style="color:#e8ba36;">(</span><span style="color:#89ca78;">"""</span><span style="color:#89ca78;background-color:#2d3139;">DROP TABLE IF EXISTS articles</span><span style="color:#89ca78;">"""</span><span style="color:#e8ba36;">)<br></span><span style="color:#e8ba36;">        </span><span style="color:#d55fde;font-style:italic;">self</span>.curr.<span style="color:#61afef;">execute</span><span style="color:#e8ba36;">(</span><span style="color:#89ca78;">"""</span><span style="color:#89ca78;background-color:#2d3139;">CREATE TABLE articles(<br></span><span style="color:#89ca78;background-color:#2d3139;">            title text,<br></span><span style="color:#89ca78;background-color:#2d3139;">            author text,<br></span><span style="color:#89ca78;background-color:#2d3139;">        )</span><span style="color:#89ca78;">"""</span><span style="color:#e8ba36;">)<br></span><span style="color:#e8ba36;"><br></span><span style="color:#e8ba36;">    </span><span style="color:#d55fde;font-style:italic;">def </span><span style="color:#61afef;">process_item</span><span style="color:#e8ba36;">(</span><span style="color:#d55fde;font-style:italic;">self</span>, <span style="color:#d19a66;">item</span>, <span style="color:#7f8591;">spider</span><span style="color:#e8ba36;">)</span>:<br>        <span style="color:#d55fde;font-style:italic;">self</span>.<span style="color:#61afef;">store_db</span><span style="color:#e8ba36;">(</span><span style="color:#d19a66;">item</span><span style="color:#e8ba36;">)<br></span><span style="color:#e8ba36;">        </span><span style="color:#d55fde;font-style:italic;">return </span><span style="color:#d19a66;">item<br></span><span style="color:#d19a66;"><br></span><span style="color:#d19a66;">    </span><span style="color:#d55fde;font-style:italic;">def </span><span style="color:#61afef;">store_db</span><span style="color:#e8ba36;">(</span><span style="color:#d55fde;font-style:italic;">self</span>, <span style="color:#d19a66;">item</span><span style="color:#e8ba36;">)</span>:<br>        <span style="color:#5c6370;font-style:italic;"># Insert the item into the database<br></span><span style="color:#5c6370;font-style:italic;">        </span><span style="color:#d55fde;font-style:italic;">self</span>.curr.<span style="color:#61afef;">execute</span><span style="color:#e8ba36;">(</span><span style="color:#89ca78;">"""</span><span style="color:#89ca78;background-color:#2d3139;">INSERT INTO articles VALUES (?,?,?)</span><span style="color:#89ca78;">"""</span>, <span style="color:#54a857;">(</span><span style="color:#d19a66;">item</span><span style="color:#54a857;">[</span><span style="color:#89ca78;">'title'</span><span style="color:#54a857;">]</span><span style="color:#e8ba36;">[</span><span style="color:#d19a66;">0</span><span style="color:#e8ba36;">]</span>, <span style="color:#d19a66;">item</span><span style="color:#54a857;">[</span><span style="color:#89ca78;">'author'</span><span style="color:#54a857;">]</span><span style="color:#e8ba36;">[</span><span style="color:#d19a66;">0</span><span style="color:#e8ba36;">]</span>,<span style="color:#54a857;">)</span><span style="color:#e8ba36;">)<br></span><span style="color:#e8ba36;">        </span><span style="color:#d55fde;font-style:italic;">self</span>.conn.<span style="color:#61afef;">commit</span><span style="color:#e8ba36;">()<br></span><span style="color:#e8ba36;"><br></span></div><p>Here is a the process of storing data in two procedures explained above:</p><div style="background-color:#282c34;color:#bbbbbb;font-family:'JetBrains Mono',monospace;font-size:۹٫۸pt;white-space:pre;"><span style="color:#5c6370;font-style:italic;"># 1.Scraped data -&gt; Item containers -&gt; json/csv files<br></span><span style="color:#5c6370;font-style:italic;"># 2.Scraped data -&gt; Item containers -&gt; Pipeline -&gt; Database</span></div><p><br></p><p>FOLOWING LINKS &amp; PAGINATION:</p><p>To follow a link, use the code snippet below after the first job inside your spiders&nbsp;<span style="font-size: 20.8px; color: rgb(97, 175, 239); background-color: rgb(40, 44, 52); font-family: &quot;JetBrains Mono&quot;, monospace; white-space: pre;">parse</span><span style="font-size: 1.3rem;">&nbsp;function:</span></p><div style="background-color:#282c34;color:#bbbbbb;font-family:'JetBrains Mono',monospace;font-size:۹٫۸pt;white-space:pre;"><span style="color:#5c6370;font-style:italic;"># Follow a link to another page<br></span>next_page_url = <span style="color:#d19a66;">response</span>.<span style="color:#61afef;">css</span><span style="color:#e8ba36;">(</span><span style="color:#89ca78;">'a.next-page::attr(href)'</span><span style="color:#e8ba36;">)</span>.<span style="color:#61afef;">get</span><span style="color:#e8ba36;">()<br></span><span style="color:#d55fde;font-style:italic;">if </span>next_page_url:<br>    <span style="color:#d55fde;font-style:italic;">yield </span><span style="color:#d19a66;">response</span>.<span style="color:#61afef;">follow</span><span style="color:#e8ba36;">(</span>next_page_url, <span style="color:#d19a66;">callback</span>=<span style="color:#d55fde;font-style:italic;">self</span>.parse_next_page<span style="color:#e8ba36;">) <br></span><span style="color:#e8ba36;">            </span><span style="color:#5c6370;font-style:italic;"># callback function can be the same "parse" function.   <br></span><span style="color:#5c6370;font-style:italic;"><br></span><span style="color:#5c6370;font-style:italic;"># OR<br></span><span style="color:#5c6370;font-style:italic;"><br></span>next_page_url = <span style="color:#89ca78;">f"www.website.com/page</span><span style="color:#e8ba36;">{</span><span style="color:#d55fde;font-style:italic;">self</span>.page_number<span style="color:#e8ba36;">}</span><span style="color:#89ca78;">"<br></span><span style="color:#d55fde;font-style:italic;">if self</span>.page_number &lt; <span style="color:#d19a66;">10</span>:<br>    <span style="color:#d55fde;font-style:italic;">self</span>.page_number += <span style="color:#d19a66;">1<br></span><span style="color:#d19a66;">    </span><span style="color:#d55fde;font-style:italic;">yield </span><span style="color:#d19a66;">response</span>.<span style="color:#61afef;">follow</span><span style="color:#e8ba36;">(</span>next_page_url, <span style="color:#d19a66;">callback</span>=<span style="color:#d55fde;font-style:italic;">self</span>.parse<span style="color:#e8ba36;">)<br></span><span style="color:#e8ba36;">    </span><br></div><p><br></p><p>FILLING OUT THE FORMS:</p><p>Within the code snippet below, we first login to a website then start scarping:</p><div style="background-color:#282c34;color:#bbbbbb;font-family:'JetBrains Mono',monospace;font-size:۹٫۸pt;white-space:pre;"><div><span style="color:#d55fde;font-style:italic;">from </span>scrapy.http <span style="color:#d55fde;font-style:italic;">import </span>FormRequest<br><br><span style="color:#d55fde;font-style:italic;">class </span><span style="color:#e5c07b;">MySpider</span><span style="color:#e8ba36;">(</span>scrapy.Spider<span style="color:#e8ba36;">)</span>:<br>    name = <span style="color:#89ca78;">'login_spider'<br></span><span style="color:#89ca78;">    </span>start_urls = <span style="color:#e8ba36;">[</span><span style="color:#89ca78;">'https://example.com/login'</span><span style="color:#e8ba36;">]<br></span><span style="color:#e8ba36;"><br></span><span style="color:#e8ba36;">    </span><span style="color:#d55fde;font-style:italic;">def </span><span style="color:#61afef;">parse</span><span style="color:#e8ba36;">(</span><span style="color:#d55fde;font-style:italic;">self</span>, <span style="color:#d19a66;">response</span><span style="color:#e8ba36;">)</span>:<br>        <span style="color:#5c6370;font-style:italic;"># Handle the login here, such as extracting CSRF tokens or other form data<br></span><span style="color:#5c6370;font-style:italic;">        </span>csrf_token = <span style="color:#d19a66;">response</span>.<span style="color:#61afef;">css</span><span style="color:#e8ba36;">(</span><span style="color:#89ca78;">'input[name="csrf_token"]::attr(value)'</span><span style="color:#e8ba36;">)</span>.<span style="color:#61afef;">get</span><span style="color:#e8ba36;">()<br></span><span style="color:#e8ba36;"><br></span><span style="color:#e8ba36;">        </span><span style="color:#5c6370;font-style:italic;"># Construct the login request with form data<br></span><span style="color:#5c6370;font-style:italic;">        </span>login_data = <span style="color:#e8ba36;">{<br></span><span style="color:#e8ba36;">            </span><span style="color:#89ca78;">'username'</span>: <span style="color:#89ca78;">'your_username'</span>,<br>            <span style="color:#89ca78;">'password'</span>: <span style="color:#89ca78;">'your_password'</span>,<br>            <span style="color:#89ca78;">'csrf_token'</span>: csrf_token,<br>        <span style="color:#e8ba36;">}<br></span><span style="color:#e8ba36;"><br></span><span style="color:#e8ba36;">        </span><span style="color:#d55fde;font-style:italic;">yield </span>FormRequest.<span style="color:#61afef;">from_response</span><span style="color:#e8ba36;">(</span><span style="color:#d19a66;">response</span>, <span style="color:#d19a66;">formdata</span>=login_data,<br>                                        <span style="color:#d19a66;">callback</span>=<span style="color:#d55fde;font-style:italic;">self</span>.start_scraping<span style="color:#e8ba36;">)<br></span><span style="color:#e8ba36;"><br></span><span style="color:#e8ba36;">        </span><span style="color:#d55fde;font-style:italic;">def </span><span style="color:#7f8591;">start_scraping</span><span style="color:#e8ba36;">(</span><span style="color:#7f8591;">self</span>, <span style="color:#7f8591;">response</span><span style="color:#e8ba36;">)</span>:<br>            <span style="color:#5c6370;font-style:italic;"># Here you can start scraping the data<br></span><span style="color:#5c6370;font-style:italic;">            </span><span style="color:#d55fde;font-style:italic;">pass</span></div></div><p><br></p><p>BYPASSING WEBSITE RESTRICTIONS:</p><p>1.User-Agent: It can be rotated automatically using the library scrapy-user-agent. First install it using pip:&nbsp;<span style="background-color: rgb(40, 44, 52); color: rgb(187, 187, 187); font-family: &quot;JetBrains Mono&quot;, monospace; white-space: pre;">pip install scrapy-user-agents</span><span style="font-size: 1.3rem;">&nbsp;, Then add the following lines to&nbsp;</span><span style="font-size: 20.8px; background-color: rgb(40, 44, 52); color: rgb(187, 187, 187); font-family: &quot;JetBrains Mono&quot;, monospace; white-space: pre;">settings.py</span><span style="font-size: 1.3rem;">:</span></p><div style="background-color:#282c34;color:#bbbbbb;font-family:'JetBrains Mono',monospace;font-size:۹٫۸pt;white-space:pre;"><div>DOWNLOADER_MIDDLEWARES = <span style="color:#e8ba36;">{<br></span><span style="color:#e8ba36;">    </span><span style="color:#89ca78;">'scrapy.downloadermiddlewares.useragent.UserAgentMiddleware'</span>: <span style="color:#d55fde;font-style:italic;">None</span>,  <br>    <span style="color:#5c6370;font-style:italic;"># Disable the default User-Agent middleware<br></span><span style="color:#5c6370;font-style:italic;">    </span><span style="color:#89ca78;">'scrapy_user_agents.middlewares.RandomUserAgentMiddleware'</span>: <span style="color:#d19a66;">400</span>,  <br>    <span style="color:#5c6370;font-style:italic;"># Enable the rotating User-Agent middleware<br></span><span style="color:#e8ba36;">}</span></div></div><p>2.Proxy: It can be set and rotavated automatically using&nbsp;scrapy-rotating-proxies. use this link to learn more:&nbsp;https://github.com/TeamHG-Memex/scrapy-rotating-proxies</p><p>You can find free proxies by searching inside GitHub within google.</p><p>3.JavaScript Handling: Opening websites with heavy java scripts or the ones which identify robots, can be done using Scrapy-Playwright: https://github.com/scrapy-plugins/scrapy-playwright</p><p><br></p><p>ADDITIONALS:</p><p>OPEN THE BROWSER in any stage of web scraping:(e.g. to see which page is being scraped.) (it shows a saved version of the website.)</p><div style="background-color: rgb(40, 44, 52); color: rgb(187, 187, 187); font-family: &quot;JetBrains Mono&quot;, monospace; white-space: pre;"><span style="color: rgb(213, 95, 222); font-style: italic;">from </span>scrapy.utils.response <span style="color: rgb(213, 95, 222); font-style: italic;">import </span>open_in_browser<br><br><span style="color: rgb(213, 95, 222); font-style: italic;">class </span><span style="color: rgb(229, 192, 123);">BlogSpider</span><span style="color: rgb(232, 186, 54);">(</span>scrapy.Spider<span style="color: rgb(232, 186, 54);">)</span>:<br>    ...<br><br>    <span style="color: rgb(213, 95, 222); font-style: italic;">def </span><span style="color: rgb(97, 175, 239);">parse</span><span style="color: rgb(232, 186, 54);">(</span><span style="color: rgb(213, 95, 222); font-style: italic;">self</span>, <span style="color: rgb(209, 154, 102);">response</span><span style="color: rgb(232, 186, 54);">)</span>:<br>        <span style="color: rgb(97, 175, 239);">open_in_browser</span><span style="color: rgb(232, 186, 54);">(</span><span style="color: rgb(209, 154, 102);">response</span><span style="color: rgb(232, 186, 54);">)<br></span><span style="color: rgb(232, 186, 54);">        </span>...</div><div style="background-color: rgb(40, 44, 52); color: rgb(187, 187, 187); font-family: &quot;JetBrains Mono&quot;, monospace; white-space: pre;"><br></div><p>------</p>
</section>
<!--Till Here-->

<footer id="footer"></footer>
</body>
</html>



