<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <link rel="stylesheet" href="bases/style.css">
    <script src="bases/script.js"></script>
    <script src="bases/jquery.js"></script>
    <script>
        $(function () {
            $("#header").load("bases/uni-header.html");
            $("#footer").load("bases/uni-footer.html")
        });
    </script>
    <title>Flask-SocketIO</title>
</head>

<body>
<header id="header"></header>

<!--The Documentation Section Goes Here-->
<section id="Flask-SocketIO">
<hr>
<h3>Flask-SocketIO</h3>
    <p>Flask-SocketIO is an extension to enables the server to communicate with the client and vice versa. <a target="_blank" href="https://flask-socketio.readthedocs.io/en/latest/">Docs</a>&nbsp; /&nbsp; <a target="_blank" href="https://www.squash.io/implementing-real-time-features-with-flask-socketio-and-websockets/">Tutorial</a></p><p>initialization:</p><pre style="background-color:#282c34;color:#abb2bf;font-family:'JetBrains Mono',monospace;font-size:۹٫۸pt;"><pre style="font-family: &quot;JetBrains Mono&quot;, monospace;"><pre style="font-family: &quot;JetBrains Mono&quot;, monospace;"><div style="background-color: rgb(30, 31, 34); color: rgb(188, 190, 196);"><span style="color:#cf8e6d;">from </span>flask <span style="color:#cf8e6d;">import </span>Flask, render_template<br><span style="color:#cf8e6d;">from </span>flask_socketio <span style="color:#cf8e6d;">import </span>SocketIO, emit<br><br>app = Flask<span style="color:#e8ba36;">(</span>__name__<span style="color:#e8ba36;">)<br></span>app.config<span style="color:#e8ba36;">[</span><span style="color:#6aab73;">'SECRET_KEY'</span><span style="color:#e8ba36;">] </span>= <span style="color:#6aab73;">'secret!'<br></span>socketio = SocketIO<span style="color:#e8ba36;">(</span>app<span style="color:#e8ba36;">)<br></span><span style="color:#e8ba36;"><br></span><span style="color:#b3ae60;">@app.route</span><span style="color:#e8ba36;">(</span><span style="color:#6aab73;">'/'</span><span style="color:#e8ba36;">)<br></span><span style="color:#cf8e6d;">def </span><span style="color:#56a8f5;">index</span><span style="color:#e8ba36;">()</span>:<br>    <span style="color:#cf8e6d;">return </span>render_template<span style="color:#e8ba36;">(</span><span style="color:#6aab73;">'index.html'</span><span style="color:#e8ba36;">)<br></span><span style="color:#e8ba36;"><br></span><span style="color:#e8ba36;"><br></span><span style="color:#cf8e6d;">if </span>__name__ == <span style="color:#6aab73;">'__main__'</span>:<br>    socketio.run<span style="color:#e8ba36;">(</span>app<span style="color:#e8ba36;">)   </span><span style="color:#7a7e85;">### socket-io has to run the app<br></span><span style="color:#7a7e85;">    <br></span><span style="color:#7a7e85;">    </span></div></pre></pre></pre><div style="background-color:#1e1f22;color:#bcbec4;font-family:'JetBrains Mono',monospace;font-size:۹٫۸pt;white-space:pre;"><span style="color:#e8ba36;">&lt;script </span><span style="color:#bababa;">src</span><span style="color:#6aab73;">="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js"<br></span><span style="color:#6aab73;">            </span><span style="color:#bababa;">integrity</span><span style="color:#6aab73;">="sha512-q/dWJ3kcmjBLU4Qc47E4A9kTB4m3wuTY7vkFJDTZKjTs8jhyGQnaUrxa0Ytd0ssMZhbNua9hE+E7Qv1j+DyZwA=="<br></span><span style="color:#6aab73;">            </span><span style="color:#bababa;">crossorigin</span><span style="color:#6aab73;">="anonymous"</span><span style="color:#e8ba36;">&gt;<br></span><span style="color:#e8ba36;">&lt;/script&gt;<br></span><span style="color:#e8ba36;"><br><br></span><span style="color:#e8ba36;">&lt;script&gt;</span></div><div style="background-color:#1e1f22;color:#bcbec4;font-family:'JetBrains Mono',monospace;font-size:۹٫۸pt;white-space:pre;"><span style="color:#e8ba36;">connecting the client side:<br></span><span style="color:#cf8e6d;">var </span><span style="color:#c77dba;font-style:italic;">socket </span>= io();   <br><span style="color:#e8ba36;">&lt;/script&gt;</span></div>
<p>Imagine we want to send data from the 'Client side' to the 'Server':</p>
<pre style="background-color:#282c34;color:#abb2bf;font-family:'JetBrains Mono',monospace;font-size:۹٫۸pt;"><div style="background-color: rgb(30, 31, 34); color: rgb(188, 190, 196);"><span style="color:#e8ba36;">Sending data:</span></div><div style="background-color: rgb(30, 31, 34); color: rgb(188, 190, 196);"><span style="color:#e8ba36;"><br></span></div><div style="background-color: rgb(30, 31, 34); color: rgb(188, 190, 196);"><span style="color:#e8ba36;">&lt;script&gt;<br></span><span style="color:#7a7e85;">// Emit event1<br></span>socket.<span style="color:#c77dbb;">emit</span>(<span style="color:#6aab73;">'event1'</span>, {<span style="color:#c77dbb;">data</span>: <span style="color:#6aab73;">'Data for event1'</span>});<br><br><span style="color:#7a7e85;">// Emit event2<br></span>socket.<span style="color:#c77dbb;">emit</span>(<span style="color:#6aab73;">'event2'</span>, {<span style="color:#c77dbb;">data</span>: <span style="color:#6aab73;">'Data for event2'</span>}, random_var);<br><span style="color:#e8ba36;">&lt;/script&gt;</span></div></pre>
<div style="background-color:#1e1f22;color:#bcbec4;font-family:'JetBrains Mono',monospace;font-size:۹٫۸pt;white-space:pre;"><span style="color:#b3ae60;">Getting data:</span></div><div style="background-color:#1e1f22;color:#bcbec4;font-family:'JetBrains Mono',monospace;font-size:۹٫۸pt;white-space:pre;"><span style="color:#b3ae60;"><br></span></div><div style="background-color:#1e1f22;color:#bcbec4;font-family:'JetBrains Mono',monospace;font-size:۹٫۸pt;white-space:pre;"><span style="color:#b3ae60;">@socketio.on</span><span style="color:#e8ba36;">(</span><span style="color:#6aab73;">'event1'</span><span style="color:#e8ba36;">)<br></span><span style="color:#cf8e6d;">def </span><span style="color:#56a8f5;">handle_event1</span><span style="color:#e8ba36;">(</span>json<span style="color:#e8ba36;">)</span>:<br>    <span style="color:#8888c6;">print</span><span style="color:#e8ba36;">(</span><span style="color:#6aab73;">'Received event1: ' </span>+ <span style="color:#8888c6;">str</span><span style="color:#54a857;">(</span>json<span style="color:#54a857;">)</span><span style="color:#e8ba36;">)<br></span><span style="color:#e8ba36;"><br></span><span style="color:#b3ae60;">@socketio.on</span><span style="color:#e8ba36;">(</span><span style="color:#6aab73;">'event2'</span><span style="color:#e8ba36;">)<br></span><span style="color:#cf8e6d;">def </span><span style="color:#56a8f5;">handle_event2</span><span style="color:#e8ba36;">(</span><span style="color:#6f737a;">json, random_var</span><span style="color:#e8ba36;">)</span>:<br>    <span style="color:#8888c6;">print</span><span style="color:#e8ba36;">(</span><span style="color:#6aab73;">'Received event2: ' </span>+ <span style="color:#8888c6;">str</span><span style="color:#e8ba36;">)</span></div><p>Now we want to send data from the 'Server' to the 'Client' and update a part of the page:</p><div style="background-color:#1e1f22;color:#bcbec4;font-family:'JetBrains Mono',monospace;font-size:۹٫۸pt;white-space:pre;"><span style="color:#b3ae60;">sending data:</span></div><div style="background-color:#1e1f22;color:#bcbec4;font-family:'JetBrains Mono',monospace;font-size:۹٫۸pt;white-space:pre;"><span style="color:#b3ae60;"><br></span></div><div style="background-color:#1e1f22;color:#bcbec4;font-family:'JetBrains Mono',monospace;font-size:۹٫۸pt;white-space:pre;"><span style="color:#b3ae60;">@socketio.on</span><span style="color:#e8ba36;">(</span><span style="color:#6aab73;">'my event'</span><span style="color:#e8ba36;">)<br></span><span style="color:#cf8e6d;">def </span><span style="color:#56a8f5;">handle_my_custom_event</span><span style="color:#e8ba36;">(</span><span style="color:#e8ba36;">)</span>:<br>    emit<span style="color:#e8ba36;">(</span><span style="color:#6aab73;">'response'</span>, <span style="color:#e8ba36;">{</span><span style="color:#6aab73;">'data'</span>: <span style="color:#6aab73;">'This is a response from the server!'</span><span style="color:#e8ba36;">})</span></div><div style="background-color:#1e1f22;color:#bcbec4;font-family:'JetBrains Mono',monospace;font-size:۹٫۸pt;white-space:pre;"><span style="color:#e8ba36;"><br></span></div><div style="background-color:#1e1f22;color:#bcbec4;font-family:'JetBrains Mono',monospace;font-size:۹٫۸pt;white-space:pre;"><br></div><p><br></p><div style="background-color:#1e1f22;color:#bcbec4;font-family:'JetBrains Mono',monospace;font-size:۹٫۸pt;white-space:pre;"><span style="color:#e8ba36;">Getting data and Replacing:</span></div><div style="background-color:#1e1f22;color:#bcbec4;font-family:'JetBrains Mono',monospace;font-size:۹٫۸pt;white-space:pre;"><span style="color:#e8ba36;"><br></span></div><div style="background-color:#1e1f22;color:#bcbec4;font-family:'JetBrains Mono',monospace;font-size:۹٫۸pt;white-space:pre;"><span style="color:#e8ba36;">&lt;script&gt;</span><span style="color:#e8ba36;"><br></span><span style="color:#e8ba36;">        </span>socket.<span style="color:#56a8f5;">on</span>(<span style="color:#6aab73;">'</span><span style="color: rgb(106, 171, 115);">response</span><span style="color:#6aab73;">'</span>, <span style="color:#cf8e6d;">function</span>(data) {<br>            <span style="color:#cf8e6d;">var </span><span style="color:#a9b7c6;">dataDiv </span>= <span style="color:#c77dba;font-style:italic;">document</span>.<span style="color:#56a8f5;">getElementById</span>(<span style="color:#6aab73;">'data'</span>);<br>            <span style="color:#a9b7c6;">dataDiv</span>.<span style="color:#c77dbb;">innerHTML </span>= <span style="color:#6aab73;">'</span><span style="color:#6aab73;background-color:#293c40;">&lt;p&gt;</span><span style="color:#6aab73;">' </span>+ data + <span style="color:#6aab73;">'</span><span style="color:#6aab73;background-color:#293c40;">&lt;/p&gt;</span><span style="color:#6aab73;">'</span>;<br>        });<br><span style="color:#e8ba36;">&lt;/script&gt;<br></span></div><p>If You want to redirect to another page within the same page, use this 'emit':</p><div style="background-color:#1e1f22;color:#bcbec4;font-family:'JetBrains Mono',monospace;font-size:۹٫۸pt;white-space:pre;"><br><span style="color:#cf8e6d;">return </span>emit(<span style="color:#6aab73;">'redirect'</span>, {<span style="color:#6aab73;">'url'</span>: url_for(<span style="color:#6aab73;">'todos'</span>, list_id=list_id)})<br><br></div><p>&nbsp;ATTENTION:</p><p>A server-side function (python) can 'get' and 'send(<span style="background-color: rgb(30, 31, 34); color: rgb(188, 190, 196); font-family: &quot;JetBrains Mono&quot;, monospace; white-space: pre;">emit</span><span style="font-size: 1.3rem;">)' data but, a client-side function (javascript) can just be used for one job.</span></p><p><br></p>
</section>
<!--Till Here-->

<footer id="footer"></footer>
</body>
</html>



